Refactor the parser module
CHANGES:
1. Extract parsing logic
2. Add error handling